/**
 * BeerProto
 *
 * Another beer format, written in protocol buffer.
 *
 * Copyright (c) 2020 Ross Merrigan
 */
syntax = "proto3";

package beerproto.v1;

import "beerproto/v1/measureable_units.proto";
import "buf/validate/validate.proto";

// EquipmentBase The descriptive base type for brew day equipment. Provides unique properties to fully describe the recipe.
message EquipmentBase {
  string name = 1 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.min_len = 3
  ];
  string type = 2;
  EquipmentBaseForm form = 3 [
    (buf.validate.field).required = true,
    (buf.validate.field).enum = {
      not_in: [0]
    }
  ];
  VolumeType maximum_volume = 4 [(buf.validate.field).required = true];
}

// EquipmentType provides necessary information for individual brewing equipment
message EquipmentItemType {
  EquipmentBase base = 1 [(buf.validate.field).required = true];
  string id = 2 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.uuid = true
  ];
  string notes = 3;
  // The volume boiled off during 1 hour, measured before and after at room temperature.
  VolumeType boil_rate_per_hour = 4;
  // The volume that leaves the kettle, especially important for non-immersion chillers that cool the wort as it leaves the kettle.
  VolumeType drain_rate_per_minute = 5;
  // The specific heat of the piece of equipment, expressed in Cal/(g*C), especially important for when the mashtun is not preheated.
  SpecificHeatType specific_heat = 6;
  // The apparent volume absorbed by grain, typical values are 0.125 qt/lb (1.04 L/kg) for a mashtun, 0.08 gal/lb (0.66 L/kg) for BIAB.
  SpecificVolumeType grain_absorption_rate = 7;
  // The weight of the piece of equipment, especially important for when the mashtun is not preheated.
  MassType weight = 8;
  VolumeType loss = 9 [(buf.validate.field).required = true];
  PercentType efficiency = 10;
}

enum EquipmentBaseForm {
  EQUIPMENT_BASE_FORM_UNSPECIFIED = 0;
  // HLT
  EQUIPMENT_BASE_FORM_HLT = 1;
  // Mash Tun
  EQUIPMENT_BASE_FORM_MASH_TUN = 2;
  // Lauter Tun
  EQUIPMENT_BASE_FORM_LAUTER_TUN = 3;
  // Brew Kettle
  EQUIPMENT_BASE_FORM_BREW_KETTLE = 4;
  // Fermenter
  EQUIPMENT_BASE_FORM_FERMENTER = 5;
  // Aging Vessel
  EQUIPMENT_BASE_FORM_AGING_VESSEL = 6;
  // Packaging Vessel
  EQUIPMENT_BASE_FORM_PACKAGING_VESSEL = 7;
}

// Provides necessary information for brewing equipment set
message EquipmentType {
  string id = 1 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.uuid = true
  ];
  string name = 2 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.min_len = 3
  ];
  repeated EquipmentItemType equipment_items = 3 [(buf.validate.field).repeated.min_items = 1];
  PercentType brewhouse_efficiency = 4;
}
