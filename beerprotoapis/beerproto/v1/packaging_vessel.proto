/**
 * BeerProto
 *
 * Another beer format, written in protocol buffer.
 *
 * Copyright (c) 2020 Ross Merrigan
 */
syntax = "proto3";

package beerproto.v1;

import "beerproto/v1/measureable_units.proto";
import "beerproto/v1/packaging_graphic.proto";
import "buf/validate/validate.proto";

message PackagingVesselBase {
  string name = 1 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.min_len = 3
  ];  
  PackagingVesselUnit type = 2;

  VolumeType vessel_volume = 3;
  int32 vessel_quantity = 4;
  string description = 5;
  repeated PackagingGraphicType graphics = 6;

}

enum PackagingVesselUnit {
  PACKAGING_VESSEL_UNIT_UNSPECIFIED = 0;
  // keg
  PACKAGING_VESSEL_UNIT_KEG = 1;
  // bottle
  PACKAGING_VESSEL_UNIT_BOTTLE = 2;
  // cask
  PACKAGING_VESSEL_UNIT_CASK = 3;
  // tank
  PACKAGING_VESSEL_UNIT_TANK = 4;
  // firkin
  PACKAGING_VESSEL_UNIT_FIRKIN = 5;
  // other
  PACKAGING_VESSEL_UNIT_OTHER = 6;
  // can
  PACKAGING_VESSEL_UNIT_CAN = 7;
}
 
// PackagingVesselType - a per vessel representation of a packaging process
message PackagingVesselType {
  PackagingVesselBase base = 1;
  string id = 2 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.uuid = true
  ];
}

message PackagingVesselStepType {
  PackagingVesselBase base = 1;
  // Unique within the recipe
  string id = 2 [
    (buf.validate.field).required = true,
    (buf.validate.field).string.uuid = true
  ];


  string package_date = 3;

  // Process step duration at packaging
  TimeType step_time = 4;

  GravityType start_gravity = 5;
  GravityType end_gravity = 6;

  AcidityType start_ph = 7;
  AcidityType end_ph = 8;

  TemperatureType start_temperature = 9;
  TemperatureType end_temperature = 10;

  // What carbonation method is used for THIS recipe/vessel
  CarbonationMethod carbonation_method = 11;

  // Target carbonation for this vessel (vols or g/L)
  CarbonationType target_carbonation = 12;

  // Computed / logged residual carbonation before packaging (optional)
  CarbonationType residual_carbonation = 13;

  // How much extra we're adding (target - residual)
  CarbonationType additional_carbonation = 14;

  // Force-carb specific
  PressureType force_carb_pressure = 15;
  TimeType force_carb_duration = 16;

  // Priming specific
  MassType priming_sugar = 17;
  string priming_sugar_type = 18; // or an enum later
}